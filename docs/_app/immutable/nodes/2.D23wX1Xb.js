import"../chunks/DsnmJJEf.js";import{i as Ee}from"../chunks/CDUjkjLN.js";import{b as qn,l as pn,w as _t,d as Vn,g as ie,s as ve,e as V,o as ut,c as bn,f as Kn}from"../chunks/B2iRUoxs.js";import{w as be,aE as Un,aF as Zn,aG as jn,aH as Jn,aI as Qn,aJ as ea,e as L,M as yn,F as Fe,aK as ta,p as Te,aL as ce,aM as ht,l as ne,t as de,a as ee,m as Oe,T as k,P,n as C,o as E,q as I,h as o,aN as U,aO as Sn,f as na,aP as aa}from"../chunks/BFB6pIza.js";import{i as We,s as xt,a as pe,p as Gt,b as ze}from"../chunks/BjJBHLk7.js";const Bt=[...` 	
\r\f¬†\v\uFEFF`];function ia(e,t,a){var i=e==null?"":""+e;if(a){for(var n in a)if(a[n])i=i?i+" "+n:n;else if(i.length)for(var r=n.length,l=0;(l=i.indexOf(n,l))>=0;){var s=l+r;(l===0||Bt.includes(i[l-1]))&&(s===i.length||Bt.includes(i[s]))?i=(l===0?"":i.substring(0,l))+i.substring(s+1):l=s}}return i===""?null:i}function oa(e,t){return e==null?null:String(e)}function Ye(e,t,a,i,n,r){var l=e.__className;if(be||l!==a||l===void 0){var s=ia(a,i,r);(!be||s!==e.getAttribute("class"))&&(s==null?e.removeAttribute("class"):e.className=s),e.__className=a}else if(r&&n!==r)for(var h in r){var g=!!r[h];(n==null||g!==!!n[h])&&e.classList.toggle(h,g)}return r}function et(e,t,a,i){var n=e.__style;if(be||n!==t){var r=oa(t);(!be||r!==e.getAttribute("style"))&&(r==null?e.removeAttribute("style"):e.style.cssText=r),e.__style=t}return i}const ra=Symbol("is custom element"),sa=Symbol("is html");function Ie(e){if(be){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var i=e.value;tt(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var n=e.checked;tt(e,"checked",null),e.checked=n}}};e.__on_r=a,jn(a),qn()}}function tt(e,t,a,i){var n=la(e);be&&(n[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||n[t]!==(n[t]=a)&&(t==="loading"&&(e[Jn]=a),a==null?e.removeAttribute(t):typeof a!="string"&&ca(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function la(e){return e.__attributes??={[ra]:e.nodeName.includes("-"),[sa]:e.namespaceURI===Un}}var Lt=new Map;function ca(e){var t=Lt.get(e.nodeName);if(t)return t;Lt.set(e.nodeName,t=[]);for(var a,i=e,n=Element.prototype;n!==i;){a=Qn(i);for(var r in a)a[r].set&&t.push(r);i=Zn(i)}return t}function Ze(e,t,a=t){var i=ea(),n=new WeakSet;pn(e,"input",r=>{var l=r?e.defaultValue:e.value;if(l=mt(e)?vt(l):l,a(l),Fe!==null&&n.add(Fe),i&&l!==(l=t())){var s=e.selectionStart,h=e.selectionEnd;e.value=l??"",h!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(h,e.value.length))}}),(be&&e.defaultValue!==e.value||L(t)==null&&e.value)&&(a(mt(e)?vt(e.value):e.value),Fe!==null&&n.add(Fe)),yn(()=>{var r=t();if(e===document.activeElement){var l=ta??Fe;if(n.has(l))return}mt(e)&&r===vt(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function $t(e,t,a=t){pn(e,"change",i=>{var n=i?e.defaultChecked:e.checked;a(n)}),(be&&e.defaultChecked!==e.checked||L(t)==null)&&a(e.checked),yn(()=>{var i=t();e.checked=!!i})}function mt(e){var t=e.type;return t==="number"||t==="range"}function vt(e){return e===""?null:+e}const Mn="zenZoneTimerSettings",kt={workDuration:Math.max(1,25)*60,shortBreakDuration:Math.max(1,5)*60,longBreakDuration:Math.max(1,15)*60,sessionsBeforeLongBreak:Math.max(1,4),autoCycle:!1};function pt(e){const t={...kt,...e};return t.workDuration=Math.max(1,Math.floor(t.workDuration/60))*60,t.shortBreakDuration=Math.max(1,Math.floor(t.shortBreakDuration/60))*60,t.longBreakDuration=Math.max(1,Math.floor(t.longBreakDuration/60))*60,t.sessionsBeforeLongBreak=Math.max(1,Math.floor(t.sessionsBeforeLongBreak)),t}function wn(){if(typeof window<"u"&&window.localStorage){const e=localStorage.getItem(Mn);if(e)try{const t=JSON.parse(e);if(t&&typeof t.workDuration=="number"&&typeof t.shortBreakDuration=="number"&&typeof t.longBreakDuration=="number"&&typeof t.sessionsBeforeLongBreak=="number"&&typeof t.autoCycle=="boolean")return pt(t);if(t)return console.warn("Partially invalid settings found in localStorage, attempting to sanitize."),pt(t)}catch(t){console.error("Error parsing timer settings from localStorage:",t)}}return pt(kt)}const da=wn(),ua={currentSession:"Work",timeRemaining:da.workDuration,isRunning:!1,currentCycleCount:0},ae=_t(wn()),K=_t(ua);typeof window<"u"&&window.localStorage&&ae.subscribe(e=>{try{localStorage.setItem(Mn,JSON.stringify(e))}catch(t){console.error("Error saving timer settings to localStorage:",t)}});const ha=Vn(K,e=>{const t=Math.floor(e.timeRemaining/60),a=e.timeRemaining%60;return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`});let Z;function An(){const e=ie(K);if(e.isRunning&&e.timeRemaining>0)return;let t=e.timeRemaining;if(t<=0){const a=ie(ae);switch(e.currentSession){case"Work":t=a.workDuration;break;case"Short Break":t=a.shortBreakDuration;break;case"Long Break":t=a.longBreakDuration;break}}K.update(a=>({...a,isRunning:!0,timeRemaining:t})),Z&&clearInterval(Z),Z=setInterval(()=>{const a=ie(K);a.isRunning&&a.timeRemaining>0?K.update(i=>({...i,timeRemaining:i.timeRemaining-1})):a.isRunning&&a.timeRemaining<=0&&(Z&&clearInterval(Z),Z=void 0,ma())},1e3)}function ga(){Z&&(clearInterval(Z),Z=void 0),K.update(e=>({...e,isRunning:!1}))}function fa(){Z&&(clearInterval(Z),Z=void 0),K.update(e=>{let t,a,i=e.currentCycleCount,n=kt;return ae.subscribe(l=>{n=l})(),e.currentSession==="Work"?(i++,i>=n.sessionsBeforeLongBreak?(t="Long Break",a=n.longBreakDuration,i=0):(t="Short Break",a=n.shortBreakDuration)):(t="Work",a=n.workDuration),{...e,currentSession:t,timeRemaining:a,isRunning:!1,currentCycleCount:i}})}function _n(e){Z&&(clearInterval(Z),Z=void 0);const t=ie(ae),a=e||ie(K).currentSession;let i=t.workDuration,n=ie(K).currentCycleCount;switch(a){case"Work":i=t.workDuration,e==="Work"&&(n=0);break;case"Short Break":i=t.shortBreakDuration;break;case"Long Break":i=t.longBreakDuration;break}K.update(r=>({...r,currentSession:a,timeRemaining:i,isRunning:!1,currentCycleCount:n}))}function Nt(e){K.update(t=>{if(t.isRunning)return t;const a=Math.max(60,e);return ae.update(i=>{const n={...i};switch(t.currentSession){case"Work":n.workDuration=a;break;case"Short Break":n.shortBreakDuration=a;break;case"Long Break":n.longBreakDuration=a;break}return n}),{...t,timeRemaining:a}})}function ma(){const e=ie(K),t=ie(ae);let a,i=e.currentCycleCount;e.currentSession==="Work"?(i++,i>=t.sessionsBeforeLongBreak?(a="Long Break",i=0):a="Short Break"):a="Work",K.update(n=>({...n,currentSession:a,isRunning:!1,currentCycleCount:i})),_n(a),t.autoCycle&&An()}var va=ne('<div class="mx-2 flex scale-75 flex-col items-center justify-center opacity-60 transition-opacity hover:opacity-100"><button title="Increase minutes" aria-label="Increase minutes" class="p-1 text-gray-300 hover:text-teal-300 disabled:opacity-30"><svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg></button> <button title="Decrease minutes" aria-label="Decrease minutes" class="p-1 text-gray-300 hover:text-teal-300 disabled:opacity-30"><svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div>'),pa=ne('<div class="mt-2 mb-8 text-center"><p class="mb-2 text-xl font-semibold text-teal-400" id="current-session-label"> </p> <div class="relative flex items-center justify-center font-mono text-8xl tracking-tighter text-gray-100 tabular-nums select-none svelte-1sjqirj" aria-live="polite" aria-atomic="true"><!> <span class="w-32 text-center"> </span> <span class="w-8 text-center">:</span> <span class="w-32 text-center"> </span></div> <div class="mt-6 h-2.5 w-full overflow-hidden rounded-full bg-slate-700 shadow-inner"><div class="h-2.5 rounded-full bg-teal-500 transition-all duration-1000 ease-linear" aria-valuemin="0" aria-valuemax="100" aria-labelledby="current-session-label" role="progressbar"></div></div></div>');function ba(e,t){Te(t,!1);const[a,i]=xt(),n=()=>pe(K,"$timerState",a),r=()=>pe(ae,"$timerSettings",a),l=()=>pe(ha,"$formattedTime",a),s=P(),h=P();let g=P(0);function u(){if(n().isRunning)return;const D=Math.floor(n().timeRemaining/60),_=n().timeRemaining%60,x=(D+1)*60+_;Nt(x)}function p(){if(n().isRunning)return;const D=Math.floor(n().timeRemaining/60),_=n().timeRemaining%60,x=Math.max(0,D-1)*60+_;Nt(x)}ce(()=>(n(),r()),()=>{const D=n(),_=r();let x=_.workDuration;D.currentSession==="Short Break"?x=_.shortBreakDuration:D.currentSession==="Long Break"&&(x=_.longBreakDuration),x=Math.max(1,x),x>0?k(g,Math.max(0,100-D.timeRemaining/x*100)):k(g,D.timeRemaining>0?0:100)}),ce(()=>l(),()=>{k(s,l().substring(0,2))}),ce(()=>l(),()=>{k(h,l().substring(3,5))}),ht(),Ee();var b=pa(),d=C(b),c=C(d,!0);E(d);var S=I(d,2),w=C(S);{var O=D=>{var _=va(),x=C(_),H=I(x,2);E(_),de(()=>{x.disabled=(n(),L(()=>n().isRunning)),H.disabled=(n(),L(()=>n().isRunning||n().timeRemaining<120&&n().timeRemaining%60===0&&n().timeRemaining/60<=1||n().timeRemaining<60))}),V("click",x,u),V("click",H,p),ee(D,_)};We(w,D=>{n(),L(()=>!n().isRunning)&&D(O)})}var v=I(w,2),X=C(v,!0);E(v);var T=I(v,4),A=C(T,!0);E(T),E(S);var $=I(S,2),F=C($);E($),E(b),de(()=>{ve(c,(n(),L(()=>n().currentSession))),ve(X,o(s)),ve(A,o(h)),et(F,`width: ${o(g)??""}%;`),tt(F,"aria-valuenow",o(g))}),ee(e,b),Oe(),i()}var ya=ne(`<button class="rounded-md border border-slate-400/30 bg-white/10 px-6 py-3 text-base font-semibold
             text-slate-200 transition-all duration-150 ease-in-out hover:bg-white/20 hover:text-teal-300
             focus:ring-2 focus:ring-teal-400
             focus:ring-offset-2 focus:ring-offset-slate-900/50 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50"> </button>`),Sa=ne(`<button class="rounded-md border border-slate-400/30 bg-white/10 px-6 py-3 text-base font-semibold
             text-slate-200 transition-all duration-150 ease-in-out hover:bg-white/20 hover:text-amber-300
             focus:ring-2 focus:ring-amber-300
             focus:ring-offset-2 focus:ring-offset-slate-900/50 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50" aria-label="Pause timer">Pause</button>`),Ma=ne(`<div class="mt-6 flex justify-center space-x-2"><!> <button class="rounded-md border border-slate-400/30 bg-white/10 px-6 py-3 text-base font-semibold
           text-slate-200 transition-all duration-150 ease-in-out hover:bg-white/20 hover:text-sky-300
           focus:ring-2 focus:ring-sky-400
           focus:ring-offset-2 focus:ring-offset-slate-900/50 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50" aria-label="Skip to next session" title="Skip to next session">Skip <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="ml-1 inline h-5 w-5 align-text-bottom"><path fill-rule="evenodd" d="M2 10a.75.75 0 0 1 .75-.75h12.59l-2.1-1.95a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.1-1.95H2.75A.75.75 0 0 1 2 10Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M18 10a.75.75 0 0 1-.75.75h-.008a.75.75 0 0 1 0-1.5h.008A.75.75 0 0 1 18 10Z" clip-rule="evenodd"></path></svg></button> <button class="rounded-md border border-slate-400/30 bg-white/10 px-6 py-3 text-base font-semibold
           text-slate-200 transition-all duration-150 ease-in-out hover:bg-white/20 hover:text-rose-300
           focus:ring-2 focus:ring-rose-400
           focus:ring-offset-2 focus:ring-offset-slate-900/50 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50" aria-label="Reset current session timer" title="Reset current session">Reset <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="ml-1 inline h-5 w-5 align-text-bottom"><path fill-rule="evenodd" d="M15.323 3.407a.75.75 0 0 1 0 1.06l-2.096 2.096A6.5 6.5 0 0 1 10 16.5a6.501 6.501 0 0 1-6.414-5.523.75.75 0 0 1 1.482-.236A5.001 5.001 0 0 0 10 15a5 5 0 0 0 4.19-2.402l-1.618 1.617a.75.75 0 1 1-1.06 1.061l3.25-3.25a.75.75 0 0 1 0-1.06l-3.25-3.25a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path><path fill-rule="evenodd" d="M4.677 12.593a.75.75 0 0 1 0-1.06l2.096-2.096A6.5 6.5 0 0 1 10 3.5a6.501 6.501 0 0 1 6.414 5.523.75.75 0 0 1-1.482.236A5.001 5.001 0 0 0 10 5a5 5 0 0 0-4.19 2.402l1.618-1.617a.75.75 0 1 1 1.06-1.061L5.238 8.075a.75.75 0 0 1 0 1.06l3.25 3.25a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd"></path></svg></button></div>`);function wa(e,t){Te(t,!1);const[a,i]=xt(),n=()=>pe(K,"$timerState",a),r=()=>pe(ae,"$timerSettings",a);let l=P();ce(()=>(n(),r()),()=>{const d=n(),c=r();k(l,!d.timeRemaining||d.currentSession==="Work"&&d.timeRemaining===c.workDuration||d.currentSession==="Short Break"&&d.timeRemaining===c.shortBreakDuration||d.currentSession==="Long Break"&&d.timeRemaining===c.longBreakDuration)}),ht(),Ee();var s=Ma(),h=C(s);{var g=d=>{var c=ya(),S=C(c,!0);E(c),de(()=>{tt(c,"aria-label",o(l)?"Start timer":"Resume timer"),ve(S,o(l)?"Start":"Resume")}),V("click",c,function(...w){An?.apply(this,w)}),ee(d,c)},u=d=>{var c=Sa();V("click",c,function(...S){ga?.apply(this,S)}),ee(d,c)};We(h,d=>{n(),L(()=>!n().isRunning)?d(g):d(u,!1)})}var p=I(h,2),b=I(p,2);E(s),de(()=>{p.disabled=(n(),L(()=>n().isRunning)),b.disabled=(n(),o(l),L(()=>n().isRunning&&o(l)))}),V("click",p,function(...d){fa?.apply(this,d)}),V("click",b,function(...d){_n?.apply(this,d)}),ee(e,s),Oe(),i()}const Xt=20,se={gradientColor1:"hsl(210, 70%, 50%)",gradientColor2:"hsl(200, 68%, 50%)",isFloatingEnabled:!0,gradientColor1History:["hsl(210, 70%, 50%)"],gradientColor1HistoryIndex:0,gradientColor2History:["hsl(200, 68%, 50%)"],gradientColor2HistoryIndex:0,isAutoCyclingColor1:!1,isAutoCyclingColor2:!1};function xn(e){if(!e)return null;const t=e.match(/hsl\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)/);return t?{h:parseInt(t[1]),s:parseInt(t[2]),l:parseInt(t[3])}:null}function Ft(){const e=ie(te);return xn(e.gradientColor1)||{h:210,s:70,l:50}}function Ht(){const e=ie(te);return xn(e.gradientColor2)||{h:200,s:68,l:50}}function Aa(){let e={...se,gradientColor1History:[...se.gradientColor1History],gradientColor2History:[...se.gradientColor2History]};if(typeof localStorage<"u"){const t=localStorage.getItem("backgroundSettings");if(t)try{const a=JSON.parse(t);e={...e,...a,isAutoCyclingColor1:a.isAutoCyclingColor1??se.isAutoCyclingColor1,isAutoCyclingColor2:a.isAutoCyclingColor2??se.isAutoCyclingColor2},!a.gradientColor1History||a.gradientColor1History.length===0?(e.gradientColor1History=[e.gradientColor1],e.gradientColor1HistoryIndex=0):(e.gradientColor1HistoryIndex=Math.max(0,Math.min(a.gradientColor1HistoryIndex??0,a.gradientColor1History.length-1)),e.gradientColor1=a.gradientColor1History[e.gradientColor1HistoryIndex]),!a.gradientColor2History||a.gradientColor2History.length===0?(e.gradientColor2History=[e.gradientColor2],e.gradientColor2HistoryIndex=0):(e.gradientColor2HistoryIndex=Math.max(0,Math.min(a.gradientColor2HistoryIndex??0,a.gradientColor2History.length-1)),e.gradientColor2=a.gradientColor2History[e.gradientColor2HistoryIndex])}catch(a){return console.error("Failed to parse background settings from localStorage",a),{...se,gradientColor1History:[...se.gradientColor1History],gradientColor2History:[...se.gradientColor2History]}}}return e}const _a=Aa(),te=_t(_a);typeof localStorage<"u"&&te.subscribe(e=>{localStorage.setItem("backgroundSettings",JSON.stringify(e))});function kn(e,t,a){let i=[...t];a<i.length-1&&(i=i.slice(0,a+1)),i.push(e),i.length>Xt&&(i=i.slice(i.length-Xt));const n=i.length-1;return{history:i,index:n}}function zt(e,t,a){let i;typeof e=="string"?i=e:i=`hsl(${Math.round(e)}, ${Math.round(t)}%, ${Math.round(a)}%)`;const n=ie(te);if(n.gradientColor1===i)return;const{history:r,index:l}=kn(i,n.gradientColor1History,n.gradientColor1HistoryIndex);te.update(s=>({...s,gradientColor1:i,gradientColor1History:r,gradientColor1HistoryIndex:l}))}function Yt(e,t,a){let i;typeof e=="string"?i=e:i=`hsl(${Math.round(e)}, ${Math.round(t)}%, ${Math.round(a)}%)`;const n=ie(te);if(n.gradientColor2===i)return;const{history:r,index:l}=kn(i,n.gradientColor2History,n.gradientColor2HistoryIndex);te.update(s=>({...s,gradientColor2:i,gradientColor2History:r,gradientColor2HistoryIndex:l}))}function xa(){te.set({...se,gradientColor1History:[...se.gradientColor1History],gradientColor2History:[...se.gradientColor2History]})}const ka={mouseMove:{maxRadius:50,speed:.35,lineWidth:1,initialOpacity:.35,color:"rgb(100, 180, 255)",decayRate:.005},click:{maxRadius:85,speed:.9,lineWidth:2.2,initialOpacity:.95,color:"rgb(190, 230, 255)",decayRate:.008},ambient:{maxRadius:30,speed:.2,lineWidth:1,initialOpacity:.15,color:"rgb(150, 200, 255)",decayRate:.008},longPress:{maxRadius:150,speed:.3,lineWidth:3.5,initialOpacity:.85,color:"rgb(70, 140, 220)",decayRate:.006},glintExpire:{maxRadius:40,speed:.9,lineWidth:1,initialOpacity:.6,color:"rgba(255, 255, 230, 0.7)",decayRate:.02}},Ra=2e3,Rn=128,Ia=16,Ca=.05,Ea=30,Ta=400,Oa=10,Wt=.0011,Da=.003,In=3e3,bt=2,Pa=15,Ga="rgba(255, 255, 234, 0.95)",Cn=4,Ba=1e3,qt=3,Vt=.15,La=.3,Kt=.2,$a=.5,Ut=45,Na=60,nt=.6,at=.6,Zt=1,Xa=2.25,Fa=600,jt=.05,Ha=.25,Jt=.5,za=1.25,Qt=.25,Ya=.55,Wa=6e4,qa=5e3,Ce=[{x1:0,y1:0,x2:1,y2:1},{x1:.5,y1:0,x2:.5,y2:1},{x1:1,y1:0,x2:0,y2:1},{x1:1,y1:.5,x2:0,y2:.5},{x1:1,y1:1,x2:0,y2:0},{x1:.5,y1:1,x2:.5,y2:0},{x1:0,y1:1,x2:1,y2:0},{x1:0,y1:.5,x2:1,y2:.5}],En=25e3,Va=.55,Ka="rgba(235, 245, 255, 0.7)",Ua="rgba(210, 230, 245, 0.5)",en=.5,Za=1.5,Me=15,tn=5,ja=12,nn=500,Ja=1e3,Qa=.2,je=.02,yt=.12,an=.005,St=.05,on=.02,ei=.3,Mt=Math.PI/4,rn=25,ti=100,ni=.25,sn=10,ai=Math.PI/3,ii=2,ln=30,oi=70,ri=.25,wt={plane:{minSpeed:.25,maxSpeed:.5,minSize:25,maxSize:45,baseOpacity:.4,minDuration:1e4,maxDuration:2e4,chancePerInterval:.01},whaleShadow:{minSpeed:.18,maxSpeed:.32,minSize:40,maxSize:70,baseOpacity:.5,minDuration:1200,maxDuration:2500,chancePerInterval:.09}};function si(e){const t=Math.max(0,Math.min(1,e));return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}const Je=15,Qe=.04;function li(e,t,a){const i=(e*Qe+t*Qe*.3+a*.8)*Math.PI*2,n=(e*Qe*.7-t*Qe+a*.5)*Math.PI*2,r=Math.sin(i)*Je*.6+Math.sin(n)*Je*.4,l=Math.cos(i)*Je*.4+Math.cos(n)*Je*.6;return{dx:r,dy:l}}let cn=0,dn=0,un=0,ci=0,hn=0,gn=0,di=0,fn=0;const it=[],ot=[],rt=[],Tn=[],st=[],lt=[],On=[],ct=[],Dn=[],Pn=[],Gn=[],Bn=[],Ln=[],$n=[],Nn=[],ui=()=>it,gt=()=>ot,Xn=()=>rt,Rt=()=>Tn,It=()=>st,Ct=()=>lt,qe=()=>On,dt=()=>ct;function hi(e){let t=Dn.pop();t?(t.x=e.x,t.y=e.y,t.radius=e.radius,t.maxRadius=e.maxRadius,t.opacity=e.opacity,t.speed=e.speed,t.lineWidth=e.lineWidth,t.color=e.color,t.isAmbient=e.isAmbient,t.decayRate=e.decayRate,t.id=cn++):t={...e,id:cn++},it.push(t)}function gi(e){let t=$n.pop();t?(t.x=e.x,t.y=e.y,t.radius=e.radius,t.currentMaxRadius=e.currentMaxRadius,t.opacity=e.opacity,t.growthSpeed=e.growthSpeed,t.opacitySpeed=e.opacitySpeed,t.color=e.color,t.vx=e.vx,t.vy=e.vy,t.isWave=e.isWave,t.relativeXInSpawn=e.relativeXInSpawn,t.relativeYInSpawn=e.relativeYInSpawn,t.baseVx=e.baseVx,t.baseVy=e.baseVy,t.id=dn++):t={...e,id:dn++},ot.push(t)}function fi(e){let t=Pn.pop();t?(t.x=e.x,t.y=e.y,t.radius=e.radius,t.opacity=e.opacity,t.decay=e.decay,t.color=e.color,t.id=un++):t={...e,id:un++},rt.push(t)}const mi=e=>{Tn.push({...e,id:ci++})};function vi(e){let t=Gn.pop();t?(t.x=e.x,t.y=e.y,t.radius=e.radius,t.opacity=e.opacity,t.decay=e.decay,t.color=e.color,t.id=hn++):t={...e,id:hn++},st.push(t)}function pi(e){let t=Bn.pop();t?(t.type=e.type,t.x=e.x,t.y=e.y,t.vx=e.vx,t.vy=e.vy,t.size=e.size,t.opacity=e.opacity,t.age=0,t.maxAge=e.maxAge,e.type==="whaleShadow"?(t.bodyAngle=e.bodyAngle??0,t.bodyAngleSpeed=e.bodyAngleSpeed,t.bodyAngleAmplitude=e.bodyAngleAmplitude,t.tailAngleOffset=e.tailAngleOffset??0,t.tailOscillationSpeed=e.tailOscillationSpeed,t.tailOscillationAmplitude=e.tailOscillationAmplitude):(delete t.bodyAngle,delete t.bodyAngleSpeed,delete t.bodyAngleAmplitude,delete t.tailAngleOffset,delete t.tailOscillationSpeed,delete t.tailOscillationAmplitude),t.id=gn++):t={...e,age:0,id:gn++},lt.push(t)}const bi=e=>{On.push({...e,id:di++})};function yi(e){let t=Ln.pop();t?(t.anchorX=e.anchorX,t.anchorY=e.anchorY,t.particles=[],t.vx=e.vx,t.vy=e.vy,t.opacity=0,t.age=0,t.maxAge=e.maxAge,t.color=e.color,t.id=fn++):t={...e,particles:[],opacity:0,age:0,id:fn++},ct.push(t)}function Si(e,t){let a=Nn.pop();a?(a.x=t.x,a.y=t.y,a.size=t.size,a.opacity=0,a.initialRelativeX=t.initialRelativeX,a.initialRelativeY=t.initialRelativeY,a.appearAtAge=t.appearAtAge,a.maxOpacity=t.maxOpacity,a.particleAge=0,a.particleMaxAge=t.particleMaxAge):a={...t,opacity:0,particleAge:0},e.particles.push(a)}function Mi(e){const t=it.findIndex(a=>a.id===e.id);if(t!==-1){const a=it.splice(t,1)[0];a&&Dn.push(a)}else console.warn(`Attempted to release ripple with ID ${e.id} not found in active list.`)}function wi(){if(ot.length>0){const e=ot.shift();if(e)return $n.push(e),e}return null}function Ai(e){const t=rt.findIndex(a=>a.id===e.id);if(t!==-1){const a=rt.splice(t,1)[0];a&&Pn.push(a)}else console.warn(`Attempted to release glint with ID ${e.id} not found in active list.`)}function _i(e){const t=st.findIndex(a=>a.id===e.id);if(t!==-1){const a=st.splice(t,1)[0];a&&Gn.push(a)}else console.warn(`Attempted to release sunGlint with ID ${e.id} not found in active list.`)}function xi(e){const t=lt.findIndex(a=>a.id===e.id);if(t!==-1){const a=lt.splice(t,1)[0];a&&Bn.push(a)}else console.warn(`Attempted to release rareSighting with ID ${e.id} not found in active list.`)}function Fn(e){Nn.push(e)}function At(e){const t=ct.findIndex(a=>a.id===e.id);if(t!==-1){const a=ct.splice(t,1)[0];if(a){for(const i of a.particles)Fn(i);a.particles=[],Ln.push(a)}}else console.warn(`Attempted to release foamStreak with ID ${e.id} not found in active list.`)}function He(e,t,a){const i=ka[a];if(!i)throw console.error(`Unknown ripple type: ${a}. Ensure it is defined in RIPPLE_CONFIG.`),new Error(`Unknown ripple type: ${a}`);let n=i.speed,r=i.maxRadius;(a==="mouseMove"||a==="click")&&(n=i.speed*(.9+Math.random()*.2),r=i.maxRadius*(.9+Math.random()*.2)),hi({x:e,y:t,radius:0,maxRadius:r,opacity:i.initialOpacity,speed:n,lineWidth:i.lineWidth,color:i.color,isAmbient:a==="ambient",decayRate:i.decayRate})}function ki(e){const t=e.globalAlpha,a=ui();for(let i=a.length-1;i>=0;i--){const n=a[i];if(n.radius+=n.speed,n.opacity-=n.decayRate,n.opacity<=0||n.radius>=n.maxRadius){Mi(n);continue}e.beginPath(),e.arc(n.x,n.y,n.radius,0,Math.PI*2),e.lineWidth=n.lineWidth,e.strokeStyle=n.color,e.globalAlpha=Math.max(0,n.opacity),e.stroke()}e.globalAlpha=t}function mn(e,t,a){gt().length>=Rn&&wi();let i,n,r,l,s,h,g,u=1;const p=e*(1-nt)/2,b=e*nt,d=t*(1-at)/2,c=t*at,S=p+Math.random()*b,w=d+Math.random()*c;a?(i=Math.min(e,t)/2*(.8+Math.random()*.4),u=Kt+Math.random()*($a-Kt),n=(Math.random()-.5)*.2*u,r=(Math.random()-.5)*.2*u,l=Vt+Math.random()*(La-Vt),s=(Math.random()*.015+.005)*(Math.random()<.5?1:-1)*u,h=(Math.random()*15e-5+5e-5)*(Math.random()<.5?1:-1)*u,g=`hsl(210, ${68+Math.random()*10}%, ${Ut+Math.random()*(Na-Ut)}%)`):(i=Math.random()*80+40,n=(Math.random()-.5)*.12,r=(Math.random()-.5)*.12,l=Math.random()*.03+.01,s=(Math.random()*.02+.01)*(Math.random()<.5?1:-1),h=(Math.random()*2e-4+1e-4)*(Math.random()<.5?1:-1),g=`hsl(${200+Math.random()*20}, ${65+Math.random()*20}%, ${35+Math.random()*30}%)`),gi({x:S,y:w,radius:Math.random()*i*.3+i*.2,currentMaxRadius:i,opacity:l,growthSpeed:s,opacitySpeed:h,color:g,vx:n,vy:r,isWave:a,relativeXInSpawn:b>0?(S-p)/b:.5,relativeYInSpawn:c>0?(w-d)/c:.5,baseVx:n,baseVy:r})}function Ri(e,t,a,i){const n=gt();if(n.length===0)return;const r=e.globalCompositeOperation;e.globalCompositeOperation="screen";for(let l=n.length-1;l>=0;l--){const s=n[l];s.x+=s.vx,s.y+=s.vy,s.radius+=s.growthSpeed,s.opacity+=s.opacitySpeed,(s.opacity>.06||s.opacity<.005)&&(s.opacitySpeed*=-1,s.opacity=Math.max(.005,Math.min(.06,s.opacity))),(s.radius>s.currentMaxRadius||s.radius<s.currentMaxRadius*.2)&&(s.growthSpeed*=-1,s.radius=Math.max(10,Math.min(s.currentMaxRadius,s.radius))),(s.x-s.radius<0||s.x+s.radius>t)&&(s.vx*=-1,s.x=Math.max(s.radius,Math.min(t-s.radius,s.x))),(s.y-s.radius<0||s.y+s.radius>a)&&(s.vy*=-1,s.y=Math.max(s.radius,Math.min(a-s.radius,s.y)));const h=li(s.x,s.y,i),g=s.x+h.dx,u=s.y+h.dy,p=e.createRadialGradient(g,u,0,g,u,s.radius),b=s.color.substring(0,s.color.lastIndexOf(")"));p.addColorStop(0,`${b}, ${s.opacity})`),p.addColorStop(.7,`${b}, ${s.opacity*.5})`),p.addColorStop(1,`${b}, 0)`),e.fillStyle=p,e.beginPath(),e.arc(g,u,s.radius,0,Math.PI*2),e.fill()}e.globalCompositeOperation=r}function Ii(e,t){const a=gt();if(a.length===0)return;const i=e*(1-nt)/2,n=e*nt,r=t*(1-at)/2,l=t*at,s=i+n/2,h=r+l/2,g=Math.sqrt(Math.pow(n/2,2)+Math.pow(l/2,2))+.001;for(const u of a){const p=u.relativeXInSpawn!==void 0?u.relativeXInSpawn:Math.random(),b=u.relativeYInSpawn!==void 0?u.relativeYInSpawn:Math.random();if(u.x=i+p*n,u.y=r+b*l,u.baseVx!==void 0&&u.baseVy!==void 0){const d=Math.sqrt(Math.pow(u.x-s,2)+Math.pow(u.y-h,2)),c=Math.min(1,d/g),S=Zt+c*(Xa-Zt);u.vx=u.baseVx*S,u.vy=u.baseVy*S}if(u.isWave){const d=Math.min(e,t)/2*(.8+Math.random()*.4);u.currentMaxRadius=d,u.radius=Math.random()*d*.3+d*.2}}}const vn=[[0,0],[0,1],[0,2],[1,0],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,2],[2,0],[2,1],[2,2]];function Hn(e,t){const a=vn[Math.floor(Math.random()*vn.length)],i=a[0],n=a[1],r=e/3,l=t/3,s=n*r+Math.random()*r,h=i*l+Math.random()*l;return{x:s,y:h}}function Ci(e,t,a){if(It().length>=In)return;const i=Math.random()*Math.PI*2,n=Math.random()*a*.5;vi({x:e+Math.cos(i)*n,y:t+Math.sin(i)*n,radius:Math.random()*.6+.4,opacity:Math.random()*.3+.7,decay:Math.random()*.008+.002,color:Ga})}function Ei(e,t){const a=Math.min(e,t),{x:i,y:n}=Hn(e,t);mi({x:i,y:n,baseRadius:a*.45,radiusAmplitude:a*.12,currentRadius:a*.45,baseOpacity:.35,opacityAmplitude:.3,currentOpacity:.35,pulseAngle:Math.random()*Math.PI*2,pulseSpeed:Wt+Math.random()*(Da-Wt),vx:0,vy:0,relativeX:i/e,relativeY:n/t})}function Ti(e){const t=It();if(t.length===0)return;const a=e.globalAlpha;for(let i=t.length-1;i>=0;i--){const n=t[i];n.x+=(Math.random()-.5)*.5,n.y+=(Math.random()-.5)*.5,n.opacity-=n.decay,n.radius+=.005,n.opacity<=0?_i(n):(e.beginPath(),e.arc(n.x,n.y,n.radius,0,Math.PI*2),e.fillStyle=n.color,e.globalAlpha=Math.max(0,n.opacity),e.fill())}e.globalAlpha=a}function Oi(e){const t=Rt();if(t.length===0)return;const a=e.globalCompositeOperation;e.globalCompositeOperation="lighter";const i=e.globalAlpha;for(let n=0;n<t.length;n++){const r=t[n];r.pulseAngle+=r.pulseSpeed,r.currentRadius=r.baseRadius+Math.sin(r.pulseAngle)*r.radiusAmplitude,r.currentOpacity=r.baseOpacity+(Math.sin(r.pulseAngle*.7+Math.PI/3)*.5+.5)*r.opacityAmplitude,r.currentOpacity=Math.max(0,Math.min(1,r.currentOpacity));const l=r.baseOpacity+r.opacityAmplitude,s=l>0?Math.max(0,r.currentOpacity/l):0,h=l>0?r.baseOpacity/l:0;let g=0;if(s>0)if(s<=h){const p=h>0?s/h:0;g=Math.round(p*bt)}else{const p=1-h,b=p>0?(s-h)/p:1;g=Math.round(bt+b*(Pa-bt))}g=Math.max(0,g);for(let p=0;p<g&&(Ci(r.x,r.y,r.currentRadius),!(It().length>=In));p++);const u=e.createRadialGradient(r.x,r.y,0,r.x,r.y,r.currentRadius);u.addColorStop(0,`rgba(255, 250, 220, ${r.currentOpacity})`),u.addColorStop(.25,`rgba(255, 235, 180, ${r.currentOpacity*.8})`),u.addColorStop(.6,`rgba(255, 220, 150, ${r.currentOpacity*.4})`),u.addColorStop(1,"rgba(255, 210, 130, 0)"),e.fillStyle=u,e.globalAlpha=1,e.beginPath(),e.arc(r.x,r.y,r.currentRadius,0,Math.PI*2),e.fill()}e.globalCompositeOperation=a,e.globalAlpha=i}function Di(e,t){const a=Rt();if(a.length===0)return;const i=Math.min(e,t);for(const n of a){if(n.relativeX!==void 0&&n.relativeY!==void 0)n.x=n.relativeX*e,n.y=n.relativeY*t;else{console.warn("SunGlow missing relative coordinates during resize. Recalculating position.");const{x:r,y:l}=Hn(e,t);n.x=r,n.y=l,n.relativeX=r/e,n.relativeY=l/t}n.baseRadius=i*.45,n.radiusAmplitude=i*.12}}function Pi(e,t){Xn().length>=Ia||fi({x:Math.random()*e,y:Math.random()*t,radius:Math.random()*.25+.2,opacity:Math.random()*.4+.2,decay:Math.random()*.005+.005,color:"rgba(255, 255, 230, 0.85)"})}function Gi(e){const t=Xn();if(t.length===0)return[];const a=[],i=e.globalAlpha;for(let n=t.length-1;n>=0;n--){const r=t[n];r.opacity-=r.decay,r.opacity<=0?(a.push({x:r.x,y:r.y}),Ai(r)):(e.beginPath(),e.arc(r.x,r.y,r.radius,0,Math.PI*2),e.fillStyle=r.color,e.globalAlpha=Math.max(0,r.opacity),e.fill())}return e.globalAlpha=i,a}function Bi(e,t){e.fillRect(t.x-t.size/2,t.y-t.size/8,t.size,t.size/4),e.fillRect(t.x-t.size/6,t.y-t.size/3,t.size/3,t.size*.8)}function Li(e,t){t.bodyAngleSpeed&&t.bodyAngleAmplitude&&(t.bodyAngle=Math.sin(t.age*t.bodyAngleSpeed)*t.bodyAngleAmplitude),t.tailOscillationSpeed&&t.tailOscillationAmplitude&&(t.tailAngleOffset=Math.sin(t.age*t.tailOscillationSpeed)*t.tailOscillationAmplitude);const n=t.size*(1+Math.sin(t.age*.02)*.05),r=n/3.5,l=r*.9,s=n*.3;e.save(),e.translate(t.x,t.y),e.rotate(t.bodyAngle||0),e.beginPath(),e.ellipse(0,0,n/2,r/2,0,0,Math.PI*2),e.fill();const h=-n/2*.85,g=0;e.save(),e.translate(h,g),e.rotate(t.tailAngleOffset||0),e.beginPath(),e.ellipse(0,0,s/2,l/2,0,0,Math.PI*2),e.fill(),e.restore(),e.restore()}function $i(e,t,a){if(Ct().length>=Cn)return;const i=a,n=wt[i];if(!n){console.warn(`Configuration not found for rare sighting type: ${i}`);return}let r,l,s,h;const g=n.minSpeed+Math.random()*(n.maxSpeed-n.minSpeed);switch(i){case"plane":r=Math.random()<.5?-n.maxSize:e+n.maxSize,l=Math.random()*t*.3,s=(r<0?1:-1)*g,h=(Math.random()-.5)*g*.3;break;case"whaleShadow":r=Math.random()<.5?-n.maxSize*1.5:e+n.maxSize*1.5,l=t*(.5+Math.random()*.4),s=(r<0?1:-1)*g,h=(Math.random()-.5)*g*.1;break;default:console.warn(`Unhandled rare sighting type for creation: ${i}`);return}const u={type:i,x:r,y:l,vx:s,vy:h,size:n.minSize+Math.random()*(n.maxSize-n.minSize),opacity:n.baseOpacity,age:0,maxAge:n.minDuration+Math.random()*(n.maxDuration-n.minDuration),...i==="whaleShadow"?{bodyAngle:0,bodyAngleSpeed:(Math.random()*.003+.002)*(Math.random()<.5?1:-1),bodyAngleAmplitude:Math.PI/36,tailAngleOffset:0,tailOscillationSpeed:Math.random()*.04+.03,tailOscillationAmplitude:Math.PI/10}:{}};pi(u)}function Ni(e,t,a){const i=Ct();if(i.length===0)return;const n=e.globalAlpha;for(let r=i.length-1;r>=0;r--){const l=i[r];l.age++,l.x+=l.vx,l.y+=l.vy;const s=l.size*2,h=l.age>l.maxAge,g=l.x<-s||l.x>t+s||l.y<-s||l.y>a+s;if(h||g){xi(l);continue}let u=l.opacity;const p=.8;if(l.age/l.maxAge>p){const b=(l.age/l.maxAge-p)/(1-p);u=l.opacity*(1-b)}switch(u=Math.max(0,u),e.globalAlpha=u,e.fillStyle=`rgba(10, 10, 20, ${u*.7})`,l.type){case"plane":Bi(e,l);break;case"whaleShadow":Li(e,l);break;default:console.warn(`No drawing function implemented for rare sighting type: ${l.type}`)}}e.globalAlpha=n}function Xi(e,t){if(qe().length>0){console.warn("Attempted to re-initialize water grains. Skipping.");return}for(let a=0;a<Fa;a++){const i=jt+Math.random()*(Ha-jt),n=Math.random()*Math.PI*2,r=20+Math.random()*10,l=Math.random()*e,s=Math.random()*t;bi({x:l,y:s,vx:Math.cos(n)*i,vy:Math.sin(n)*i,size:Jt+Math.random()*(za-Jt),opacity:Qt+Math.random()*(Ya-Qt),color:`hsl(210, ${65+Math.random()*10}%, ${r}%)`,relativeX:e>0?l/e:.5,relativeY:t>0?s/t:.5})}console.log(`Initialized ${qe().length} water grains.`)}function Fi(e,t,a){const i=qe();if(i.length===0)return;const n=e.globalAlpha;for(const r of i)r.x+=r.vx,r.y+=r.vy,r.x<-r.size?r.x=t+r.size:r.x>t+r.size&&(r.x=-r.size),r.y<-r.size?r.y=a+r.size:r.y>a+r.size&&(r.y=-r.size),e.beginPath(),e.arc(r.x,r.y,r.size,0,Math.PI*2),e.fillStyle=r.color,e.globalAlpha=Math.max(0,r.opacity*n),e.fill();e.globalAlpha=n}function Hi(e,t){const a=qe();if(a.length!==0)for(const i of a)i.relativeX!==void 0&&i.relativeY!==void 0?(i.x=i.relativeX*e,i.y=i.relativeY*t):(console.warn("WaterGrain missing relative coordinates during resize. Re-randomizing position."),i.x=Math.random()*e,i.y=Math.random()*t,i.relativeX=e>0?i.x/e:.5,i.relativeY=t>0?i.y/t:.5)}function zi(e,t){if(dt().length>=En)return;const a=Math.floor(Math.random()*3);let i,n,r,l,s;a===0?(i=Math.random()*e,n=-Me,r=(Math.random()-.5)*yt*.5,l=an+Math.random()*(St-an),s=Math.PI/2+(Math.random()-.5)*(Math.PI/6)):a===1?(i=-Me,n=Math.random()*t,r=je+Math.random()*(yt-je),l=(Math.random()-.5)*St*.4,s=(Math.random()-.5)*(Math.PI/4)):(i=e+Me,n=Math.random()*t,r=-(je+Math.random()*(yt-je)),l=(Math.random()-.5)*St*.4,s=Math.PI+(Math.random()-.5)*(Math.PI/4));let h=0;const g=(d,c,S,w,O,v)=>{let X=c,T=S,A=w;for(let $=0;$<O;$++){const F=tn+Math.random()*(ja-tn);if(A+=(Math.random()-.5)*2*Mt,v){const x=(A-w+Math.PI*3)%(Math.PI*2)-Math.PI;Math.abs(x)>Mt*1.5&&(A=w+Math.sign(x)*Mt*1.5)}else a===0?A=Math.max(Math.PI/4,Math.min(3*Math.PI/4,A)):a===1?A=Math.max(-Math.PI/3,Math.min(Math.PI/3,A)):A=Math.max(2*Math.PI/3,Math.min(4*Math.PI/3,A));const D=X+Math.cos(A)*F,_=T+Math.sin(A)*F;for(let x=0;x<ii;x++){const H=en+Math.random()*(Za-en),j=A+Math.PI/2,R=(Math.random()-.5)*Me*.8,W=X+Math.cos(j)*R,q=T+Math.sin(j)*R;Si(d,{x:W,y:q,initialRelativeX:W,initialRelativeY:q,size:H,opacity:0,appearAtAge:h++*ei,maxOpacity:.5+Math.random()*.4,particleAge:0,particleMaxAge:ln+Math.random()*(oi-ln)})}if(X=D,T=_,!v&&Math.random()<ni&&$<O-sn/2&&$>2){const x=(Math.random()<.5?-1:1)*ai*(.7+Math.random()*.6),H=Math.floor(sn*(.5+Math.random()*.5));g(d,X,T,A+x,H,!0)}}},u=rn+Math.floor(Math.random()*(ti-rn+1));g(0,0,s,u,!1);const p={anchorX:i,anchorY:n,particles:[],vx:r,vy:l,opacity:0,age:0,maxAge:nn+Math.random()*(Ja-nn),color:Math.random()<.6?Ka:Ua};yi(p);const b=dt().find(d=>d.anchorX===i&&d.anchorY===n&&d.age===0);if(b){if(g(b,0,0,s,u,!1),b.particles.length<5){At(b);return}}else console.warn("Could not find newly added streak to generate particles into.")}function Yi(e,t,a){const i=dt();if(i.length===0)return;const n=e.globalAlpha,r=e.globalCompositeOperation;e.globalCompositeOperation="lighter";for(let l=i.length-1;l>=0;l--){const s=i[l];s.age++,s.anchorX+=s.vx,s.anchorY+=s.vy;const h=s.maxAge*Qa;if(s.age<h?s.opacity=s.age/h:s.age>s.maxAge-h?s.opacity=1-(s.age-(s.maxAge-h))/h:s.opacity=1,s.opacity=Math.max(0,Math.min(1,s.opacity)),s.opacity<=0&&s.age>h){At(s);continue}let g=!0;const u=Me*5,p=Me*5;if(s.anchorX>-u&&s.anchorX<t+u&&s.anchorY>-p&&s.anchorY<a+p)g=!1;else{g=!0;for(const b of s.particles){const d=s.anchorX+b.x,c=s.anchorY+b.y;if(d>-b.size&&d<t+b.size&&c>-b.size&&c<a+b.size){g=!1;break}}}if(g&&s.age>h*2){At(s);continue}e.fillStyle=s.color;for(let b=s.particles.length-1;b>=0;b--){const d=s.particles[b];if(s.age<d.appearAtAge)continue;if(d.particleAge++,d.particleAge>d.particleMaxAge){d.opacity=0,Fn(d),s.particles.splice(b,1);continue}else{const A=d.particleMaxAge*ri;d.particleAge<A?d.opacity=d.particleAge/A*d.maxOpacity:d.particleAge>d.particleMaxAge-A?d.opacity=(1-(d.particleAge-(d.particleMaxAge-A))/A)*d.maxOpacity:d.opacity=d.maxOpacity,d.opacity=Math.max(0,Math.min(d.maxOpacity,d.opacity))}if(d.opacity<=.001)continue;d.x+=(Math.random()-.5)*on,d.y+=(Math.random()-.5)*on;const c=d.x-d.initialRelativeX,S=d.y-d.initialRelativeY,w=c*c+S*S,O=Me*.5;if(w>O*O){const A=Math.sqrt(w);d.x=d.initialRelativeX+c/A*O,d.y=d.initialRelativeY+S/A*O}const v=s.anchorX+d.x,X=s.anchorY+d.y,T=s.opacity*d.opacity;T<=.001||(e.globalAlpha=T*n,e.beginPath(),e.arc(v,X,d.size,0,Math.PI*2),e.fill())}}e.globalCompositeOperation=r,e.globalAlpha=n}var Wi=ne('<canvas class="pointer-events-none fixed top-0 left-0 -z-10 h-full w-full svelte-1mnusik"></canvas>');function qi(e,t){Te(t,!1);let a=Gt(t,"gradientColor1",8,"hsl(210, 70%, 50%)"),i=Gt(t,"gradientColor2",8,"hsl(200, 68%, 50%)"),n=P(),r,l=0,s=0,h=0,g=1,u=0,p={...Ce[0]},b=0;ut(()=>{const c=o(n);if(!c){console.error("Canvas not available onMount");return}const S=c.getContext("2d");if(!S){console.error("Context not available onMount");return}H(),console.log(`[onMount after initial resize] Canvas: ${c.width}x${c.height}`);let w=0,O=0,v=null,X,T=!1,A=0;function $(){const R=Date.now();if(u===0&&(u=R,b=R,h=(s+1)%Ce.length,g=0),R-u>=Wa&&g>=1&&(s=h,h=(s+1)%Ce.length,g=0,u=R,b=R),g<1){const W=R-b;g=Math.min(1,W/qa);const q=si(g),z=Ce[s],J=Ce[h];p.x1=z.x1+(J.x1-z.x1)*q,p.y1=z.y1+(J.y1-z.y1)*q,p.x2=z.x2+(J.x2-z.x2)*q,p.y2=z.y2+(J.y2-z.y2)*q}else p={...Ce[h]},s=h}const F=R=>{if(v){if(!T){const q=R.pageX-v.x,z=R.pageY-v.y;Math.sqrt(q*q+z*z)>Oa&&(T=!0)}const W=Date.now();W-w>Ea&&(He(R.pageX,R.pageY,"mouseMove"),w=W)}},D=R=>{O=Date.now(),v={x:R.pageX,y:R.pageY},T=!1},_=R=>{if(!v||O===0)return;const W=Date.now()-O;T||(W>=Ta?He(R.pageX,R.pageY,"longPress"):He(R.pageX,R.pageY,"mouseMove")),v=null,O=0,T=!1},x=()=>{c&&He(Math.random()*c.width,Math.random()*c.height,"ambient")};function H(){c&&(c.width=window.innerWidth,c.height=window.innerHeight,console.log(`[resizeCanvas] Canvas: ${c.width}x${c.height}`),Ii(c.width,c.height),Di(c.width,c.height),Hi(c.width,c.height))}if(window.addEventListener("resize",H),window.addEventListener("mousemove",F),window.addEventListener("mousedown",D),window.addEventListener("mouseup",_),typeof window<"u"&&(X=window.setInterval(x,Ra)),c){for(let R=0;R<Rn-qt;R++)mn(c.width,c.height,!1);for(let R=0;R<qt;R++)mn(c.width,c.height,!0);Ei(c.width,c.height),Xi(c.width,c.height)}console.log(`[onMount End] Canvas: ${c.width}x${c.height}, ShimmerSpots: ${gt().length}, Grains: ${qe().length}, SunGlows: ${Rt().length}`);function j(){if(!S||!c){r=requestAnimationFrame(j);return}l+=.002,$();const R=p.x1*c.width,W=p.y1*c.height,q=p.x2*c.width,z=p.y2*c.height,J=S.createLinearGradient(R,W,q,z),oe=typeof a()=="string"&&a().includes("hsl")?a():"hsl(210, 70%, 50%)",re=typeof i()=="string"&&i().includes("hsl")?i():"hsl(200, 68%, 50%)";if(J.addColorStop(0,oe),J.addColorStop(1,re),S.fillStyle=J,S.fillRect(0,0,c.width,c.height),ki(S),Ri(S,c.width,c.height,l),Fi(S,c.width,c.height),Oi(S),Ti(S),A+=16.67,A>=Ba){for(const le in wt){const ue=le,ge=wt[ue];typeof ge.chancePerInterval=="number"&&Math.random()<ge.chancePerInterval&&Ct().length<Cn&&$i(c.width,c.height,ue)}A=0}Ni(S,c.width,c.height),Math.random()<Ca&&Pi(c.width,c.height),Gi(S).forEach(le=>He(le.x,le.y,"glintExpire")),Math.random()<Va&&dt().length<En&&zi(c.width,c.height),Yi(S,c.width,c.height),r=requestAnimationFrame(j)}return j(),()=>{window.removeEventListener("resize",H),window.removeEventListener("mousemove",F),window.removeEventListener("mousedown",D),window.removeEventListener("mouseup",_),X&&clearInterval(X),r&&cancelAnimationFrame(r)}}),Ee();var d=Wi();ze(d,c=>k(n,c),()=>o(n)),ee(e,d),Oe()}var Vi=ne('<div class="professional-hsl-picker svelte-1bvbq9v"><div class="picker-header svelte-1bvbq9v"><div class="control-buttons svelte-1bvbq9v"><button title="Sync both gradients">üîó</button> <button title="Lock current selection">üîí</button> <button class="control-btn reset-btn svelte-1bvbq9v" title="Reset to defaults">‚Ü∫</button></div></div> <div class="slider-section svelte-1bvbq9v"><div class="slider-label svelte-1bvbq9v">Hue (0¬∞ - 360¬∞)</div> <div class="slider-container svelte-1bvbq9v"><canvas class="color-slider svelte-1bvbq9v"></canvas></div></div> <div class="slider-section svelte-1bvbq9v"><div class="slider-label svelte-1bvbq9v">Saturation (0% - 100%)</div> <div class="slider-container svelte-1bvbq9v"><canvas class="color-slider svelte-1bvbq9v"></canvas></div></div> <div class="slider-section svelte-1bvbq9v"><div class="slider-label svelte-1bvbq9v">Lightness (0% - 100%)</div> <div class="slider-container svelte-1bvbq9v"><canvas class="color-slider svelte-1bvbq9v"></canvas></div></div> <div class="color-preview svelte-1bvbq9v"><div class="preview-item svelte-1bvbq9v"><div class="preview-swatch svelte-1bvbq9v"></div> <span class="preview-label svelte-1bvbq9v"> </span></div> <div class="preview-item svelte-1bvbq9v"><div class="preview-swatch svelte-1bvbq9v"></div> <span class="preview-label svelte-1bvbq9v"> </span></div></div> <div class="instructions svelte-1bvbq9v"><p>Click: Set Gradient 1 ‚Ä¢ Drag indicators to move</p></div></div>');function Ki(e,t){Te(t,!1);const a=P(),i=P();let n=P(),r=P(),l=P(),s,h=P(null),g=P(null),u=P(null),p=P(!1),b=P(!1),d=!1,c=null,S=null;const w=320,O=40,v=16;let X=0,T={x:0,targetX:0,scale:1,opacity:.9},A={x:0,targetX:0,scale:1,opacity:.9},$={x:0,targetX:0,scale:1,opacity:.9},F={x:0,targetX:0,scale:1,opacity:.9},D={x:0,targetX:0,scale:1,opacity:.9},_={x:0,targetX:0,scale:1,opacity:.9},x;function H(){T.targetX=v+o(a).h/360*(w-2*v),A.targetX=v+o(i).h/360*(w-2*v),T.x=T.targetX,A.x=A.targetX,$.targetX=v+o(a).s/100*(w-2*v),F.targetX=v+o(i).s/100*(w-2*v),$.x=$.targetX,F.x=F.targetX,D.targetX=v+o(a).l/100*(w-2*v),_.targetX=v+o(i).l/100*(w-2*v),D.x=D.targetX,_.x=_.targetX}function j(f,y){const M=Math.max(0,Math.min(1,(f-v)/(w-2*v)));switch(y){case"hue":return M*360;case"saturation":return M*100;case"lightness":return M*100}}function R(){if(!o(h)||!o(g)||!o(u)){s=requestAnimationFrame(R);return}X+=.016;const f=d?1:.15;T.x+=(T.targetX-T.x)*f,A.x+=(A.targetX-A.x)*f,$.x+=($.targetX-$.x)*f,F.x+=(F.targetX-F.x)*f,D.x+=(D.targetX-D.x)*f,_.x+=(_.targetX-_.x)*f,[T,A,$,F,D,_].forEach((M,G)=>{const B=G%2+1;c===B&&(S==="hue"&&G<2||S==="saturation"&&G>=2&&G<4||S==="lightness"&&G>=4)?(M.scale=1+.2*Math.sin(X*8),M.opacity=.95):(M.scale+=(1-M.scale)*.1,M.opacity+=(.9-M.opacity)*.1)}),W(),s=requestAnimationFrame(R)}function W(){q(),z(),J()}function q(){if(!o(h))return;o(h).clearRect(0,0,w,O);const f=o(h).createLinearGradient(v,0,w-v,0);for(let y=0;y<=12;y++){const M=y/12*360;f.addColorStop(y/12,`hsl(${M}, 70%, 50%)`)}U(h,o(h).fillStyle=f),re(o(h),v,8,w-2*v,O-16,8),o(h).fill(),U(h,o(h).strokeStyle="rgba(255, 255, 255, 0.2)"),U(h,o(h).lineWidth=1),re(o(h),v,8,w-2*v,O-16,8),o(h).stroke(),oe(o(h),T,"#3B82F6","1"),oe(o(h),A,"#EC4899","2")}function z(){if(!o(g))return;o(g).clearRect(0,0,w,O);const f=(o(a).h+o(i).h)/2,y=o(g).createLinearGradient(v,0,w-v,0);y.addColorStop(0,`hsl(${f}, 0%, 50%)`),y.addColorStop(1,`hsl(${f}, 100%, 50%)`),U(g,o(g).fillStyle=y),re(o(g),v,8,w-2*v,O-16,8),o(g).fill(),U(g,o(g).strokeStyle="rgba(255, 255, 255, 0.2)"),U(g,o(g).lineWidth=1),re(o(g),v,8,w-2*v,O-16,8),o(g).stroke(),oe(o(g),$,"#3B82F6","1"),oe(o(g),F,"#EC4899","2")}function J(){if(!o(u))return;o(u).clearRect(0,0,w,O);const f=(o(a).h+o(i).h)/2,y=(o(a).s+o(i).s)/2,M=o(u).createLinearGradient(v,0,w-v,0);M.addColorStop(0,`hsl(${f}, ${y}%, 0%)`),M.addColorStop(.25,`hsl(${f}, ${y}%, 25%)`),M.addColorStop(.5,`hsl(${f}, ${y}%, 50%)`),M.addColorStop(.75,`hsl(${f}, ${y}%, 75%)`),M.addColorStop(1,`hsl(${f}, ${y}%, 100%)`),U(u,o(u).fillStyle=M),re(o(u),v,8,w-2*v,O-16,8),o(u).fill(),U(u,o(u).strokeStyle="rgba(255, 255, 255, 0.2)"),U(u,o(u).lineWidth=1),re(o(u),v,8,w-2*v,O-16,8),o(u).stroke(),oe(o(u),D,"#3B82F6","1"),oe(o(u),_,"#EC4899","2")}function oe(f,y,M,G){const B=y.x,N=O/2,Y=y.scale,Ne=y.opacity;f.save(),f.globalAlpha=Ne;const Xe=f.createRadialGradient(B,N,0,B,N,20*Y);Xe.addColorStop(0,M+"40"),Xe.addColorStop(1,M+"00"),f.fillStyle=Xe,f.fillRect(B-20*Y,N-20*Y,40*Y,40*Y),f.beginPath(),f.arc(B,N,10*Y,0,Math.PI*2),f.fillStyle=M,f.fill(),f.strokeStyle="rgba(255, 255, 255, 0.9)",f.lineWidth=2,f.stroke(),f.beginPath(),f.arc(B,N,6*Y,0,Math.PI*2),f.fillStyle="rgba(255, 255, 255, 0.3)",f.fill(),f.fillStyle="white",f.font=`bold ${8*Y}px system-ui`,f.textAlign="center",f.textBaseline="middle",f.fillText(G,B,N),f.restore()}function re(f,y,M,G,B,N){f.beginPath(),f.moveTo(y+N,M),f.lineTo(y+G-N,M),f.quadraticCurveTo(y+G,M,y+G,M+N),f.lineTo(y+G,M+B-N),f.quadraticCurveTo(y+G,M+B,y+G-N,M+B),f.lineTo(y+N,M+B),f.quadraticCurveTo(y,M+B,y,M+B-N),f.lineTo(y,M+N),f.quadraticCurveTo(y,M,y+N,M),f.closePath()}function we(f,y){let M,G,B;switch(y){case"hue":M=o(n),G=T,B=A;break;case"saturation":M=o(r),G=$,B=F;break;case"lightness":M=o(l),G=D,B=_;break;default:return}if(!M)return;const N=M.getBoundingClientRect(),Y=f.clientX-N.left,Ne=Math.abs(Y-G.x),Xe=Math.abs(Y-B.x);if(Ne<20)d=!0,c=1,S=y,f.preventDefault();else if(Xe<20)d=!0,c=2,S=y,f.preventDefault();else{const Wn=j(Y,y);ue(y,Wn,1)}}function Ae(f){if(!d||!S||!c)return;let y;switch(S){case"hue":y=o(n);break;case"saturation":y=o(r);break;case"lightness":y=o(l);break;default:return}if(!y)return;const M=y.getBoundingClientRect(),G=f.clientX-M.left,B=Math.max(v,Math.min(w-v,G)),N=j(B,S);ue(S,N,c)}function le(){d=!1,c=null,S=null}function ue(f,y,M){const G=M===1?o(a):o(i);if(!G)return;let B=G.h,N=G.s,Y=G.l;switch(f){case"hue":B=y;break;case"saturation":N=y;break;case"lightness":Y=y;break}M===1?zt(B,N,Y):Yt(B,N,Y)}function ge(){k(b,!o(b))}function Ve(){k(p,!o(p))}function De(){zt(210,70,50),Yt(200,68,50)}ut(()=>{if(!(!o(n)||!o(r)||!o(l))&&(k(h,o(n).getContext("2d")),k(g,o(r).getContext("2d")),k(u,o(l).getContext("2d")),!(!o(h)||!o(g)||!o(u))))return U(n,o(n).width=w),U(n,o(n).height=O),U(r,o(r).width=w),U(r,o(r).height=O),U(l,o(l).width=w),U(l,o(l).height=O),H(),R(),document.addEventListener("mousemove",Ae),document.addEventListener("mouseup",le),x=te.subscribe(f=>{}),()=>{s&&cancelAnimationFrame(s),document.removeEventListener("mousemove",Ae),document.removeEventListener("mouseup",le),x&&x()}}),bn(()=>{s&&cancelAnimationFrame(s)}),ce(()=>Ft,()=>{k(a,Ft()||{h:210,s:70,l:50})}),ce(()=>Ht,()=>{k(i,Ht()||{h:200,s:68,l:50})}),ce(()=>(o(a),o(i),o(h),o(g),o(u)),()=>{o(a)&&o(i)&&typeof o(a).h=="number"&&typeof o(i).h=="number"&&(H(),o(h)&&o(g)&&o(u)&&W())}),ht(),Ee();var _e=Vi(),ye=C(_e),Pe=C(ye),xe=C(Pe);let Ge;var Se=I(xe,2);let Be;var Le=I(Se,2);E(Pe),E(ye);var ke=I(ye,2),Ke=I(C(ke),2),m=C(Ke);ze(m,f=>k(n,f),()=>o(n)),E(Ke),E(ke);var Q=I(ke,2),he=I(C(Q),2),fe=C(he);ze(fe,f=>k(r,f),()=>o(r)),E(he),E(Q);var $e=I(Q,2),me=I(C($e),2),Re=C(me);ze(Re,f=>k(l,f),()=>o(l)),E(me),E($e);var Ue=I($e,2),ft=C(Ue),Et=C(ft),Tt=I(Et,2),zn=C(Tt);E(Tt),E(ft);var Ot=I(ft,2),Dt=C(Ot),Pt=I(Dt,2),Yn=C(Pt);E(Pt),E(Ot),E(Ue),Sn(2),E(_e),de((f,y,M,G,B,N,Y,Ne)=>{Ge=Ye(xe,1,"control-btn svelte-1bvbq9v",null,Ge,f),Be=Ye(Se,1,"control-btn svelte-1bvbq9v",null,Be,y),et(Et,`background-color: hsl(${o(a),L(()=>o(a).h)??""}, ${o(a),L(()=>o(a).s)??""}%, ${o(a),L(()=>o(a).l)??""}%)`),ve(zn,`Gradient 1: ${M??""}¬∞, ${G??""}%, ${B??""}%`),et(Dt,`background-color: hsl(${o(i),L(()=>o(i).h)??""}, ${o(i),L(()=>o(i).s)??""}%, ${o(i),L(()=>o(i).l)??""}%)`),ve(Yn,`Gradient 2: ${N??""}¬∞, ${Y??""}%, ${Ne??""}%`)},[()=>({active:o(b)}),()=>({active:o(p)}),()=>(o(a),L(()=>Math.round(o(a).h))),()=>(o(a),L(()=>Math.round(o(a).s))),()=>(o(a),L(()=>Math.round(o(a).l))),()=>(o(i),L(()=>Math.round(o(i).h))),()=>(o(i),L(()=>Math.round(o(i).s))),()=>(o(i),L(()=>Math.round(o(i).l)))]),V("click",xe,ge),V("click",Se,Ve),V("click",Le,De),V("mousedown",m,f=>we(f,"hue")),V("mousedown",fe,f=>we(f,"saturation")),V("mousedown",Re,f=>we(f,"lightness")),ee(e,_e),Oe()}var Ui=ne("<div><!></div>"),Zi=ne('<div role="toolbar" aria-label="Background Effects Dock"><div class="dock-container svelte-1osm15p"><div title="Professional HSL Color Picker"><div class="dock-icon svelte-1osm15p">üé®</div></div> <div class="dock-item svelte-1osm15p" title="Water Effects"><div class="dock-icon svelte-1osm15p">üåä</div></div> <div class="dock-item svelte-1osm15p" title="Light Effects"><div class="dock-icon svelte-1osm15p">‚ú®</div></div> <div class="dock-item svelte-1osm15p" title="Particle Effects"><div class="dock-icon svelte-1osm15p">üí´</div></div> <div class="dock-item svelte-1osm15p" title="Settings"><div class="dock-icon svelte-1osm15p">‚öôÔ∏è</div></div></div> <!></div>');function ji(e,t){Te(t,!1);let a=P(),i=P(!1),n,r=0,l=0,s=P(!1);const h=100,g=3e3;ut(()=>{const _=H=>{r=H.clientY,u()},x=()=>{l=window.innerHeight};return window.addEventListener("mousemove",_),window.addEventListener("resize",x),x(),()=>{window.removeEventListener("mousemove",_),window.removeEventListener("resize",x),n&&clearTimeout(n)}});function u(){const x=l-r<=h;x&&!o(i)?p():!x&&o(i)&&d()}function p(){k(i,!0),n&&(clearTimeout(n),n=0)}function b(){k(i,!1)}function d(){n&&clearTimeout(n),n=setTimeout(b,g)}function c(){p()}function S(){d()}function w(){k(s,!o(s)),o(s)&&p()}function O(_){switch(_){case"colors":w();break}}Ee();var v=Zi();let X;var T=C(v),A=C(T);let $;Sn(8),E(T);var F=I(T,2);{var D=_=>{var x=Ui();let H;var j=C(x);Ki(j,{}),E(x),de(R=>H=Ye(x,1,"color-grid-panel svelte-1osm15p",null,H,R),[()=>({visible:o(s)})]),ee(_,x)};We(F,_=>{o(s)&&_(D)})}E(v),ze(v,_=>k(a,_),()=>o(a)),de((_,x)=>{X=Ye(v,1,"floating-dock svelte-1osm15p",null,X,_),$=Ye(A,1,"dock-item svelte-1osm15p",null,$,x)},[()=>({visible:o(i)}),()=>({active:o(s)})]),V("click",A,()=>O("colors")),V("mouseenter",v,c),V("mouseleave",v,S),ee(e,v),Oe()}var Ji=ne('<meta name="description" content="A beautiful Pomodoro timer with interactive background effects"/>'),Qi=ne('<span class="text-sm text-white/60 block mt-1"> </span>'),eo=ne('<div class="text-lg font-medium text-white/80"> <!></div>'),to=ne('<!> <!> <main class="relative z-10 flex min-h-screen flex-col items-center justify-center px-4 py-8 transition-all duration-1000 ease-in-out"><div class="w-full max-w-md space-y-8 text-center"><!> <!> <!> <div class="space-y-4 rounded-2xl bg-black/20 p-6 backdrop-blur-sm"><h3 class="text-lg font-semibold text-white/90">Timer Settings</h3> <div class="grid grid-cols-2 gap-4"><div><label for="work-duration" class="block text-sm font-medium text-white/70">Work (min)</label> <input id="work-duration" type="number" min="1" max="120" class="mt-1 w-full rounded-lg bg-white/10 px-3 py-2 text-white placeholder-white/50 backdrop-blur-sm focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-blue-500/50 svelte-k0cir4"/></div> <div><label for="short-break-duration" class="block text-sm font-medium text-white/70">Short Break (min)</label> <input id="short-break-duration" type="number" min="1" max="60" class="mt-1 w-full rounded-lg bg-white/10 px-3 py-2 text-white placeholder-white/50 backdrop-blur-sm focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-blue-500/50 svelte-k0cir4"/></div> <div><label for="long-break-duration" class="block text-sm font-medium text-white/70">Long Break (min)</label> <input id="long-break-duration" type="number" min="1" max="120" class="mt-1 w-full rounded-lg bg-white/10 px-3 py-2 text-white placeholder-white/50 backdrop-blur-sm focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-blue-500/50 svelte-k0cir4"/></div> <div><label for="sessions-before-long-break" class="block text-sm font-medium text-white/70">Sessions Before Long Break</label> <input id="sessions-before-long-break" type="number" min="1" max="10" class="mt-1 w-full rounded-lg bg-white/10 px-3 py-2 text-white placeholder-white/50 backdrop-blur-sm focus:bg-white/20 focus:outline-none focus:ring-2 focus:ring-blue-500/50 svelte-k0cir4"/></div></div> <div class="flex items-center justify-between"><label for="auto-cycle" class="text-sm font-medium text-white/70">Auto-cycle sessions</label> <input id="auto-cycle" type="checkbox" class="h-4 w-4 rounded border-white/30 bg-white/10 text-blue-600 focus:ring-blue-500/50"/></div> <div class="flex items-center justify-between"><label for="floating-enabled" class="text-sm font-medium text-white/70">Enable floating effects</label> <input id="floating-enabled" type="checkbox" class="h-4 w-4 rounded border-white/30 bg-white/10 text-blue-600 focus:ring-blue-500/50"/></div> <button type="button" class="w-full rounded-lg bg-red-600/20 px-4 py-2 text-red-300 backdrop-blur-sm hover:bg-red-600/30 focus:outline-none focus:ring-2 focus:ring-red-500/50">Reset to Defaults</button></div></div></main>',1);function so(e,t){Te(t,!1);const[a,i]=xt(),n=()=>pe(ae,"$timerSettings",a),r=()=>pe(te,"$backgroundSettings",a),l=()=>pe(K,"$timerState",a);let s=P(!1),h=P(n().workDuration/60),g=P(n().shortBreakDuration/60),u=P(n().longBreakDuration/60),p=P(n().sessionsBeforeLongBreak),b=P(n().autoCycle),d=P(r().isFloatingEnabled);const c={h:222,s:20,l:22};let S=P(c.h),w=P(c.s),O=P(c.l),v=P(c.h),X=P(c.s),T=P(c.l),A=P(0),$=P(0),F=P(0),D;ut(()=>{k(s,!0),k(d,r().isFloatingEnabled);function m(){const Q=Date.now();if(o(A)<1&&o($)>0){const he=Q-o(F);k(A,Math.min(1,he/o($)));const fe=x(o(A));k(S,_(c.h,o(v),fe)),k(w,_(c.s,o(X),fe)),k(O,_(c.l,o(T),fe))}D=requestAnimationFrame(m)}D=requestAnimationFrame(m)}),bn(()=>{D&&cancelAnimationFrame(D)});function _(m,Q,he){return m+(Q-m)*he}function x(m){return m<.5?4*m*m*m:1-Math.pow(-2*m+2,3)/2}ae.subscribe(m=>{m.workDuration/60!==o(h)&&k(h,m.workDuration/60),m.shortBreakDuration/60!==o(g)&&k(g,m.shortBreakDuration/60),m.longBreakDuration/60!==o(u)&&k(u,m.longBreakDuration/60),m.sessionsBeforeLongBreak!==o(p)&&k(p,m.sessionsBeforeLongBreak),m.autoCycle!==o(b)&&k(b,m.autoCycle)}),te.subscribe(m=>{m.isFloatingEnabled!==o(d)&&k(d,m.isFloatingEnabled)});function H(m){switch(m){case"work":return"Focus Session";case"shortBreak":return"Short Break";case"longBreak":return"Long Break";default:return"Session"}}function j(){xa()}ce(()=>(l(),o(v),o(X),o(T)),()=>{if(l().currentSession){let m;switch(l().currentSession.type){case"work":m={h:210,s:25,l:24};break;case"shortBreak":m={h:240,s:20,l:28};break;case"longBreak":m={h:250,s:18,l:32};break;default:m=c}(m.h!==o(v)||m.s!==o(X)||m.l!==o(T))&&(k(v,m.h),k(X,m.s),k(T,m.l),k(A,0),k($,2e3),k(F,Date.now()))}}),ce(()=>(o(s),o(h),o(g),o(u),o(p),o(b),n(),ae),()=>{if(o(s)){const m={workDuration:Math.max(1,o(h))*60,shortBreakDuration:Math.max(1,o(g))*60,longBreakDuration:Math.max(1,o(u))*60,sessionsBeforeLongBreak:Math.max(1,o(p)),autoCycle:o(b)};(n().workDuration!==m.workDuration||n().shortBreakDuration!==m.shortBreakDuration||n().longBreakDuration!==m.longBreakDuration||n().sessionsBeforeLongBreak!==m.sessionsBeforeLongBreak||n().autoCycle!==m.autoCycle)&&ae.set(m)}}),ce(()=>(o(s),r(),o(d),te),()=>{o(s)&&r().isFloatingEnabled!==o(d)&&te.update(m=>({...m,isFloatingEnabled:o(d)}))}),ht(),Ee();var R=to();Kn(m=>{var Q=Ji();aa.title="Locked-In Pomodoro Timer",ee(m,Q)});var W=na(R);qi(W,{get gradientColor1(){return r(),L(()=>r().gradientColor1)},get gradientColor2(){return r(),L(()=>r().gradientColor2)}});var q=I(W,2);ji(q,{});var z=I(q,2),J=C(z),oe=C(J);ba(oe,{});var re=I(oe,2);{var we=m=>{var Q=eo(),he=C(Q),fe=I(he);{var $e=me=>{var Re=Qi(),Ue=C(Re);E(Re),de(()=>ve(Ue,`Session ${l(),L(()=>l().completedSessions+1)??""} of ${n(),L(()=>n().sessionsBeforeLongBreak)??""}`)),ee(me,Re)};We(fe,me=>{l(),L(()=>l().currentSession.type==="work")&&me($e)})}E(Q),de(me=>ve(he,`${me??""} `),[()=>(l(),L(()=>H(l().currentSession.type)))]),ee(m,Q)};We(re,m=>{l(),L(()=>l().currentSession)&&m(we)})}var Ae=I(re,2);wa(Ae,{});var le=I(Ae,2),ue=I(C(le),2),ge=C(ue),Ve=I(C(ge),2);Ie(Ve),E(ge);var De=I(ge,2),_e=I(C(De),2);Ie(_e),E(De);var ye=I(De,2),Pe=I(C(ye),2);Ie(Pe),E(ye);var xe=I(ye,2),Ge=I(C(xe),2);Ie(Ge),E(xe),E(ue);var Se=I(ue,2),Be=I(C(Se),2);Ie(Be),E(Se);var Le=I(Se,2),ke=I(C(Le),2);Ie(ke),E(Le);var Ke=I(Le,2);E(le),E(J),E(z),de(()=>et(z,`background: linear-gradient(135deg, 
		hsla(${o(S)??""}, ${o(w)??""}%, ${o(O)??""}%, 0.85) 0%, 
		hsla(${o(S)+10}, ${o(w)+5}%, ${o(O)+8}%, 0.75) 100%)`)),Ze(Ve,()=>o(h),m=>k(h,m)),Ze(_e,()=>o(g),m=>k(g,m)),Ze(Pe,()=>o(u),m=>k(u,m)),Ze(Ge,()=>o(p),m=>k(p,m)),$t(Be,()=>o(b),m=>k(b,m)),$t(ke,()=>o(d),m=>k(d,m)),V("click",Ke,j),ee(e,R),Oe(),i()}export{so as component};
